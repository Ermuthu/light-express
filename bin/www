#!/usr/bin/env node
var debug = require('debug')('test');
var app = require('../app');
var fs = require('fs');

var port_plus = Number(process.env.PORT_PLUS) || 0;
var port = process.env.PORT || (80+port_plus);
var https_port = process.env.HTTPS_PORT || (443+port_plus);

require('https').createServer({
	key  : fs.readFileSync('./cert/key.pem'),
	cert : fs.readFileSync('./cert/cert.pem')
}, app).listen(https_port);

app.set('port', port);
var server = app.listen(app.get('port'), function(){
	debug('Express server listening on port ' + server.address().port);
});
